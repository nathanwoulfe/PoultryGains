"use strict";angular.module("poultryGainsApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("poultryGainsApp").controller("MainCtrl",["$scope","Data",function(a,b){function c(a,b,c,d){this.form=a,this.elOriginal=b,this.pos=d,this.type=c,this.create(),this.initEvents()}function d(a){this.el=a,this.overlay=this.el.querySelector(".nl-overlay"),this.fields=[],this.fldOpen=-1,this.init()}function e(){a.weight=200,a.gender="m",a.type="gainz",a.unit="lb",a.hasSubmit=!1}var f,g=window.document;String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),c.prototype={create:function(){"dropdown"===this.type?this.createDropDown():"input"===this.type&&this.createInput()},createDropDown:function(){var a=this,b="";this.fld=g.createElement("div"),this.fld.className="nl-field nl-dd",this.toggle=g.createElement("a"),this.toggle.innerHTML=this.elOriginal.options[this.elOriginal.selectedIndex].innerHTML,this.toggle.className="nl-field-toggle",this.optionsList=g.createElement("ul"),Array.prototype.slice.call(this.elOriginal.querySelectorAll("option")).forEach(function(c,d){b+=a.elOriginal.selectedIndex===d?'<li class="nl-dd-checked">'+c.innerHTML+"</li>":"<li>"+c.innerHTML+"</li>",a.elOriginal.selectedIndex===d&&(a.selectedIdx=d)}),this.optionsList.innerHTML=b,this.fld.appendChild(this.toggle),this.fld.appendChild(this.optionsList),this.elOriginal.parentNode.insertBefore(this.fld,this.elOriginal),this.elOriginal.style.display="none"},createInput:function(){this.fld=g.createElement("div"),this.fld.className="nl-field nl-ti-text",this.toggle=g.createElement("a"),this.toggle.innerHTML=this.elOriginal.getAttribute("value")||this.elOriginal.getAttribute("placeholder"),this.toggle.className="nl-field-toggle",this.optionsList=g.createElement("ul"),this.getinput=g.createElement("input"),this.getinput.setAttribute("type",this.elOriginal.getAttribute("type")||""),this.getinput.setAttribute("placeholder",this.elOriginal.getAttribute("placeholder")),this.getinput.setAttribute("value",this.elOriginal.getAttribute("value")||""),this.getinputWrapper=g.createElement("li"),this.getinputWrapper.className="nl-ti-input",this.inputsubmit=g.createElement("button"),this.inputsubmit.className="nl-field-go",this.inputsubmit.innerHTML="Go",this.getinputWrapper.appendChild(this.getinput),this.getinputWrapper.appendChild(this.inputsubmit),this.example=g.createElement("li"),this.example.className="nl-ti-example",this.example.innerHTML=this.elOriginal.getAttribute("data-subline"),this.optionsList.appendChild(this.getinputWrapper),this.optionsList.appendChild(this.example),this.fld.appendChild(this.toggle),this.fld.appendChild(this.optionsList),this.elOriginal.parentNode.insertBefore(this.fld,this.elOriginal),this.elOriginal.style.display="none"},initEvents:function(){var a,b=this;this.toggle.addEventListener("click",function(a){a.preventDefault(),a.stopPropagation(),b._open()}),this.toggle.addEventListener("touchstart",function(a){a.preventDefault(),a.stopPropagation(),b._open()}),"dropdown"===this.type?(a=Array.prototype.slice.call(this.optionsList.querySelectorAll("li")),a.forEach(function(c,d){c.addEventListener("click",function(d){d.preventDefault(),b.close(c,a.indexOf(c))}),c.addEventListener("touchstart",function(d){d.preventDefault(),b.close(c,a.indexOf(c))})})):"input"===this.type&&(this.getinput.addEventListener("keydown",function(a){13===a.keyCode&&b.close()}),this.inputsubmit.addEventListener("click",function(a){a.preventDefault(),b.close()}),this.inputsubmit.addEventListener("touchstart",function(a){a.preventDefault(),b.close()}))},_open:function(){if(this.open)return!1;this.open=!0,this.form.fldOpen=this.pos;this.fld.className+=" nl-field-open"},close:function(b,c){if(!this.open)return!1;if(this.open=!1,this.form.fldOpen=-1,this.fld.className=this.fld.className.replace(/\b nl-field-open\b/,""),"dropdown"===this.type){if(b){var d=this.optionsList.children[this.selectedIdx];d.className="",b.className="nl-dd-checked",this.toggle.innerHTML=b.innerHTML,this.selectedIdx=c,a[this.elOriginal.name]=this.elOriginal.children[this.selectedIdx].value}}else"input"===this.type&&(this.getinput.blur(),this.toggle.innerHTML=""!==this.getinput.value.trim()?this.getinput.value:this.getinput.getAttribute("placeholder"),a[this.elOriginal.name]=this.getinput.value)}},d.prototype={init:function(){var a=this;Array.prototype.slice.call(this.el.querySelectorAll("select")).forEach(function(b,d){a.fldOpen+=1,a.fields.push(new c(a,b,"dropdown",a.fldOpen))}),Array.prototype.slice.call(this.el.querySelectorAll('input:not([type="hidden"])')).forEach(function(b,d){a.fldOpen+=1,a.fields.push(new c(a,b,"input",a.fldOpen))}),this.overlay.addEventListener("click",function(b){a.closeFlds()}),this.overlay.addEventListener("touchstart",function(b){a.closeFlds()})},closeFlds:function(){-1!==this.fldOpen&&this.fields[this.fldOpen].close()}},f=new d(g.getElementById("nl-form")),a.data=[],a.base="kg"===a.unit?"100g":"1lb";var h=2.2046;a.submit=function(){var b=0;b="m"===a.gender?"gainz"===a.type?1.5:.8:"gainz"===a.type?1.2:.8;var c="kg"===a.unit?2.2046*parseInt(a.weight,10):parseInt(a.weight,10);a.base="kg"===a.unit?"100g":"1lb",a.intake=Math.ceil(c*b),a.hasSubmit=!0},a.getTotal=function(b){return"kg"===a.unit?b>1e3?+(b/1e3).toFixed(2)+"kg":b+"g":+(b/1e3*h).toFixed(2)+"lb"},a.getServes=function(b,c){if(a.data.length){if(c=parseInt(c,10),void 0!==c&&c>0)return Math.ceil(a.intake/parseInt(b.gsx$protein.$t,10)*c)+" "+b.gsx$servenotes.$t;if(-1!==c)return Math.ceil(a.intake/parseInt(b.gsx$protein.$t,10))}},a.notes=function(a){return a.length?"("+a+")":""},a.proteinPer100=function(b){if(a.data.length){var c=a.data[b],d=Math.round(c.gsx$protein.$t/c.gsx$serve.$t*100);return"kg"===a.unit?d+"g":Math.round(10*d/h)+"g"}},a.isChicken=function(a){return"TRUE"===a.gsx$ischicken.$t},a.notChicken=function(a){return"TRUE"!==a.gsx$ischicken.$t},b.get().then(function(b){a.data=b.data.feed.entry,e()})}]),angular.module("poultryGainsApp").controller("AboutCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("poultryGainsApp").factory("Data",["$http",function(a){var b="1Sq-psdVrf1KGJswMhcQfa8ioK4qPxAady_1Sg3j5KE4";return{get:function(c){return a.get("https://spreadsheets.google.com/feeds/list/"+b+"/od6/public/values?alt=json")}}}]);